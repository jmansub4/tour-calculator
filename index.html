.gantt-label {
            padding: 12px;
            background: #34495e;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
        }<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Military Deployment Feasibility Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 10px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
        }
        
        .header-content {
            position: relative;
            z-index: 1;
        }
        
        .header h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.3);
            letter-spacing: 1px;
        }
        
        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
            font-weight: 300;
        }
        
        .share-info {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 15px 30px;
            text-align: center;
            font-size: 0.95rem;
        }
        
        .main-layout {
            display: grid;
            grid-template-columns: 400px 1fr;
            min-height: 800px;
        }
        
        .sidebar {
            background: linear-gradient(180deg, #f8f9fa, #e9ecef);
            padding: 30px;
            border-right: 2px solid #dee2e6;
            overflow-y: auto;
        }
        
        .content-area {
            padding: 30px;
            background: white;
            overflow-y: auto;
        }
        
        .section-title {
            font-size: 1.4rem;
            color: #2c3e50;
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 3px solid #3498db;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 6px;
            color: #34495e;
            font-size: 0.9rem;
        }
        
        .input-group input, .input-group select {
            width: 100%;
            padding: 10px 14px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            background: white;
        }
        
        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
            transform: translateY(-1px);
        }
        
        .help-text {
            font-size: 0.8rem;
            color: #6c757d;
            margin-top: 4px;
            font-style: italic;
        }
        
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 25px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .calculate-btn:hover {
            background: linear-gradient(135deg, #2980b9, #3498db);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(52, 152, 219, 0.3);
        }
        
        .export-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }
        
        .export-btn {
            padding: 12px;
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .export-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 15px rgba(39, 174, 96, 0.3);
        }
        
        .export-btn.secondary {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }
        
        .export-btn.secondary:hover {
            box-shadow: 0 6px 15px rgba(243, 156, 18, 0.3);
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .result-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 12px;
            padding: 20px;
            border-left: 5px solid #3498db;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
        }
        
        .result-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
        }
        
        .result-card.success {
            border-left-color: #27ae60;
            background: linear-gradient(135deg, #d5f4e6, #c8f7c5);
        }
        
        .result-card.warning {
            border-left-color: #f39c12;
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
        }
        
        .result-card.danger {
            border-left-color: #e74c3c;
            background: linear-gradient(135deg, #f8d7da, #fab1a0);
        }
        
        .result-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .result-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #2c3e50;
            margin: 8px 0;
        }
        
        .result-label {
            font-size: 0.9rem;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
            margin: 10px 0;
        }
        
        .status-badge.success {
            background: #27ae60;
            color: white;
        }
        
        .status-badge.warning {
            background: #f39c12;
            color: white;
        }
        
        .status-badge.danger {
            background: #e74c3c;
            color: white;
        }
        
        .gantt-container {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .gantt-header {
            display: grid;
            grid-template-columns: 150px 1fr;
            background: #2c3e50;
            color: white;
            font-weight: 600;
        }
        
        .gantt-months-container {
            display: flex;
            flex-direction: column;
        }
        
        .gantt-months-row {
            display: grid;
            grid-template-columns: repeat(36, 1fr);
            gap: 1px;
            background: #34495e;
        }
        
        .gantt-months-tens {
            border-bottom: 1px solid #34495e;
        }
        
        .month-header-tens {
            padding: 6px 2px;
            text-align: center;
            font-size: 0.7rem;
            background: #2c3e50;
            color: white;
            font-weight: 600;
            border-right: 1px solid #34495e;
        }
        
        .month-header {
            padding: 6px 2px;
            text-align: center;
            font-size: 0.65rem;
            background: #2c3e50;
            color: white;
            font-weight: 500;
        }
        
        .timeline-subtitle {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 500;
        }
        
        .primary-group {
            border: 2px solid #c0392b;
        }
        
        .primary-label {
            background: linear-gradient(135deg, #c0392b, #a93226) !important;
            color: white;
            border-right-color: #c0392b !important;
        }
        
        .gantt-bar.primary {
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2);
        }
        
        .surplus-row {
            border: 2px solid #f39c12;
        }
        
        .surplus-label {
            background: linear-gradient(135deg, #f39c12, #d68910) !important;
            color: white;
            border-right-color: #f39c12 !important;
        }
        
        .gantt-bar.surplus {
            font-weight: 700;
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }
        
        .unavailable-text, .surplus-text {
            font-size: 0.7rem;
            font-style: italic;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .gantt-analysis {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .analysis-card h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .analysis-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 4px solid #3498db;
        }
        
        .analysis-label {
            font-weight: 600;
            color: #34495e;
            font-size: 0.9rem;
        }
        
        .analysis-value {
            font-weight: 700;
            color: #2c3e50;
            font-size: 0.9rem;
        }
        
        @media (max-width: 1200px) {
            .gantt-months-row {
                grid-template-columns: repeat(24, 1fr);
            }
            
            .month-header, .month-header-tens {
                font-size: 0.6rem;
                padding: 4px 1px;
            }
        }
        
        @media (max-width: 800px) {
            .gantt-header {
                grid-template-columns: 120px 1fr;
            }
            
            .gantt-row {
                grid-template-columns: 120px 1fr;
            }
            
            .gantt-months-row {
                grid-template-columns: repeat(18, 1fr);
            }
            
            .timeline-subtitle {
                font-size: 0.9rem;
            }
            
            .analysis-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .gantt-body {
            background: #ecf0f1;
        }
        
        .gantt-row {
            display: grid;
            grid-template-columns: 150px 1fr;
            border-bottom: 1px solid #bdc3c7;
        }
        
        .gantt-row:last-child {
            border-bottom: none;
        }
        
        .gantt-row-label {
            padding: 12px;
            background: #f8f9fa;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.9rem;
            text-align: center;
            border-right: 2px solid #bdc3c7;
        }
        
        .group-size {
            font-size: 0.75rem;
            color: #6c757d;
            font-weight: 400;
            margin-top: 2px;
        }
        
        .gantt-timeline {
            display: grid;
            grid-template-columns: repeat(36, 1fr);
            gap: 1px;
            background: #bdc3c7;
            padding: 1px;
        }
        
        .gantt-bar {
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 600;
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .gantt-bar:hover {
            transform: scale(1.05);
            z-index: 10;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        
        .gantt-bar.deployed {
            background: linear-gradient(135deg, #e74c3c, #c0392b) !important;
        }
        
        .gantt-bar.dwell {
            background: linear-gradient(135deg, #27ae60, #229954) !important;
        }
        
        .gantt-bar.failure {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d) !important;
        }
        
        .gantt-bar.unavailable {
            background: #ecf0f1 !important;
            color: #bdc3c7;
        }
        
        .gantt-bar.summary {
            background: linear-gradient(135deg, #3498db, #2980b9) !important;
            font-size: 0.8rem;
            font-weight: 700;
        }
        
        .summary-row .gantt-row-label {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border-right-color: #2980b9;
        }
        
        .gantt-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            padding: 15px;
            background: white;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .legend-color {
            width: 20px;
            height: 12px;
            border-radius: 3px;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        @media (max-width: 1200px) {
            .gantt-months {
                grid-template-columns: repeat(24, 1fr);
            }
            
            .gantt-timeline {
                grid-template-columns: repeat(24, 1fr);
            }
            
            .month-header {
                font-size: 0.6rem;
                padding: 6px 1px;
            }
            
            .gantt-bar {
                height: 30px;
                font-size: 0.6rem;
            }
        }
        
        @media (max-width: 800px) {
            .gantt-header {
                grid-template-columns: 120px 1fr;
            }
            
            .gantt-row {
                grid-template-columns: 120px 1fr;
            }
            
            .gantt-row-label {
                padding: 8px;
                font-size: 0.8rem;
            }
            
            .gantt-months {
                grid-template-columns: repeat(18, 1fr);
            }
            
            .gantt-timeline {
                grid-template-columns: repeat(18, 1fr);
            }
            
            .gantt-legend {
                gap: 15px;
            }
            
            .legend-item {
                font-size: 0.8rem;
            }
        }
        
        .recommendations {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 15px;
            padding: 25px;
            color: white;
            margin-top: 20px;
        }
        
        .recommendations h3 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
        }
        
        .recommendations ul {
            list-style: none;
            padding: 0;
        }
        
        .recommendations li {
            background: rgba(255, 255, 255, 0.1);
            margin: 8px 0;
            padding: 12px 15px;
            border-radius: 8px;
            border-left: 4px solid rgba(255, 255, 255, 0.5);
        }
        
        .scenario-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .tab-btn {
            padding: 8px 16px;
            background: #e9ecef;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .tab-btn.active {
            background: #3498db;
            color: white;
        }
        
        .share-section {
            background: linear-gradient(135deg, #a8e6cf, #88d8a3);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
        }
        
        .share-url {
            background: white;
            padding: 10px;
            border-radius: 8px;
            font-family: monospace;
            word-break: break-all;
            margin: 10px 0;
            border: 2px dashed #27ae60;
        }
        
        @media (max-width: 1200px) {
            .main-layout {
                grid-template-columns: 350px 1fr;
            }
        }
        
        @media (max-width: 1000px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                border-right: none;
                border-bottom: 2px solid #dee2e6;
            }
            
            .results-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 600px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .timeline-grid {
                grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            }
            
            .export-buttons {
                grid-template-columns: 1fr;
            }
        }
        
        .advanced-toggle {
            background: rgba(116, 185, 255, 0.1);
            border: 1px dashed #74b9ff;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .advanced-toggle:hover {
            background: rgba(116, 185, 255, 0.15);
        }
        
        .advanced-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .advanced-content.expanded {
            max-height: 500px;
        }
        
        .url-display {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 12px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 0.9rem;
            word-break: break-all;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .url-display:hover {
            background: #e9ecef;
            border-color: #3498db;
        }
        
        .copy-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <h1>üéñÔ∏è Military Deployment Calculator</h1>
                <p>Professional feasibility analysis with 2:1 dwell ratio compliance</p>
            </div>
        </div>
        
        <div class="share-info">
            üì§ <strong>Share this tool:</strong> Save this HTML file and share with colleagues, or host on any web server for team access
        </div>
        
        <div class="main-layout">
            <div class="sidebar">
                <h2 class="section-title">
                    üìã Unit Configuration
                </h2>
                
                <div class="input-group">
                    <label for="authorized">Authorized Soldiers</label>
                    <input type="number" id="authorized" value="60" min="1" max="1000">
                    <div class="help-text">Total authorized manning level</div>
                </div>
                
                <div class="input-group">
                    <label for="assigned">Assigned Soldiers</label>
                    <input type="number" id="assigned" value="60" min="1" max="1000">
                    <div class="help-text">Current personnel assigned to unit</div>
                </div>
                
                <div class="input-group">
                    <label for="exempt">Exempt Soldiers</label>
                    <input type="number" id="exempt" value="5" min="0" max="1000">
                    <div class="help-text">Non-deployable (medical, admin, etc.)</div>
                </div>
                
                <div class="input-group">
                    <label for="deployment-size">Deployment Size</label>
                    <input type="number" id="deployment-size" value="10" min="1" max="100">
                    <div class="help-text">Soldiers needed per deployment</div>
                </div>
                
                <div class="input-group">
                    <label for="deployment-length">Deployment Length (months)</label>
                    <input type="number" id="deployment-length" value="6" min="1" max="24" step="0.5">
                    <div class="help-text">Duration of each deployment</div>
                </div>
                
                <div class="input-group">
                    <label for="overlap">Overlap Period (months)</label>
                    <input type="number" id="overlap" value="0.5" min="0" max="3" step="0.1">
                    <div class="help-text">Handover time between rotations</div>
                </div>
                
                <div class="advanced-toggle" onclick="toggleAdvanced()">
                    <strong>‚öôÔ∏è Advanced Options</strong> <span id="toggle-icon">‚ñº</span>
                    <div class="advanced-content" id="advanced-content">
                        <div style="margin-top: 15px;">
                            <div class="input-group">
                                <label for="deployment-type">Deployment Strategy</label>
                                <select id="deployment-type">
                                    <option value="full">Full Deployment</option>
                                    <option value="staggered">50% Staggered</option>
                                </select>
                            </div>
                            
                            <div class="input-group">
                                <label for="cross-training">Cross-Training Window (months)</label>
                                <input type="number" id="cross-training" value="1" min="0" max="6" step="0.5">
                                <div class="help-text">Additional training time during overlap</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <button class="calculate-btn" onclick="calculateDeployment()">
                    üìä Calculate Feasibility
                </button>
                
                <div class="export-buttons">
                    <button class="export-btn" onclick="exportData()">
                        üìÑ Export Data
                    </button>
                    <button class="export-btn secondary" onclick="shareResults()">
                        üîó Share Results
                    </button>
                </div>
                
                <div class="share-section">
                    <h4>üì≤ Share This Tool</h4>
                    <p style="font-size: 0.9rem; margin: 10px 0;">Send this file to colleagues or host on a web server</p>
                    <button class="export-btn" onclick="saveAsFile()" style="width: 100%; margin-top: 10px;">
                        üíæ Save Copy of Tool
                    </button>
                </div>
            </div>
            
            <div class="content-area">
                <h2 class="section-title">
                    üìà Feasibility Analysis
                </h2>
                
                <div id="results-container">
                    <div class="result-card">
                        <div class="result-title">Welcome to the Military Deployment Calculator</div>
                        <p>Click "Calculate Feasibility" to analyze your deployment scenario. This tool will provide:</p>
                        <ul style="margin: 15px 0 0 20px; line-height: 1.6;">
                            <li>‚úÖ Real-time feasibility assessment</li>
                            <li>üìä Personnel requirement calculations</li>
                            <li>‚è±Ô∏è Dwell time compliance verification</li>
                            <li>üìÖ 24-month timeline visualization</li>
                            <li>üí° Strategic recommendations</li>
                            <li>üîó Easy sharing with colleagues</li>
                        </ul>
                    </div>
                </div>
                
                <div id="timeline-container"></div>
                <div id="recommendations-container"></div>
                <div id="share-container"></div>
            </div>
        </div>
    </div>
    
    <script>
        let currentResults = null;
        
        function toggleAdvanced() {
            const content = document.getElementById('advanced-content');
            const icon = document.getElementById('toggle-icon');
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                icon.textContent = '‚ñº';
            } else {
                content.classList.add('expanded');
                icon.textContent = '‚ñ≤';
            }
        }
        
        function calculateDeployment() {
            // Get input values
            const authorized = parseInt(document.getElementById('authorized').value);
            const assigned = parseInt(document.getElementById('assigned').value);
            const exempt = parseInt(document.getElementById('exempt').value);
            const deploymentSize = parseInt(document.getElementById('deployment-size').value);
            const deploymentLength = parseFloat(document.getElementById('deployment-length').value);
            const overlap = parseFloat(document.getElementById('overlap').value);
            const deploymentType = document.getElementById('deployment-type').value;
            const crossTraining = parseFloat(document.getElementById('cross-training').value);
            
            // Calculate deployable soldiers
            const deployable = assigned - exempt;
            
            // Calculate dwell time requirement (2:1 ratio)
            const dwellTime = deploymentLength * 2;
            const totalCycle = deploymentLength + dwellTime;
            
            // Calculate required personnel for sustainable operations
            let requiredPersonnel;
            if (deploymentType === 'staggered') {
                requiredPersonnel = Math.ceil(deploymentSize * 2 * (totalCycle / deploymentLength));
            } else {
                requiredPersonnel = Math.ceil(deploymentSize * (totalCycle / deploymentLength));
            }
            
            // Calculate feasibility metrics
            const feasible = deployable >= requiredPersonnel;
            const manningGap = requiredPersonnel - deployable;
            const utilizationRate = (deploymentSize / deployable * 100);
            const maxSustainable = Math.floor(deployable * deploymentLength / totalCycle);
            
            // Calculate failure point
            let failurePoint = null;
            if (!feasible) {
                failurePoint = Math.floor(deploymentLength + (deployable * deploymentLength / deploymentSize));
            }
            
            // Store results for sharing
            currentResults = {
                authorized, assigned, exempt, deployable, deploymentSize, deploymentLength,
                overlap, crossTraining, deploymentType, dwellTime, totalCycle, requiredPersonnel,
                feasible, manningGap, utilizationRate, maxSustainable, failurePoint
            };
            
            displayResults(currentResults);
            generateTimeline(currentResults);
            generateRecommendations(currentResults);
        }
        
        function displayResults(data) {
            const container = document.getElementById('results-container');
            
            // Determine status
            let statusClass = 'success';
            let statusIcon = '‚úÖ';
            let statusText = 'FULLY VIABLE';
            
            if (!data.feasible) {
                statusClass = 'danger';
                statusIcon = '‚ùå';
                statusText = 'NOT FEASIBLE';
            } else if (data.utilizationRate > 80) {
                statusClass = 'warning';
                statusIcon = '‚ö†Ô∏è';
                statusText = 'HIGH RISK';
            }
            
            container.innerHTML = `
                <div class="results-grid">
                    <div class="result-card ${statusClass}">
                        <div class="result-title">${statusIcon} Mission Status</div>
                        <div class="status-badge ${statusClass}">${statusText}</div>
                        <div class="result-label">Overall Assessment</div>
                    </div>
                    
                    <div class="result-card">
                        <div class="result-title">üë• Personnel Analysis</div>
                        <div class="result-value">${data.deployable}</div>
                        <div class="result-label">Deployable Soldiers</div>
                        <div style="margin-top: 10px; font-size: 0.9rem;">
                            Required: <strong>${data.requiredPersonnel}</strong> | 
                            Gap: <strong style="color: ${data.manningGap > 0 ? '#e74c3c' : '#27ae60'}">
                                ${data.manningGap > 0 ? '-' : '+'}${Math.abs(data.manningGap)}
                            </strong>
                        </div>
                    </div>
                    
                    <div class="result-card">
                        <div class="result-title">üìä Utilization Rate</div>
                        <div class="result-value">${data.utilizationRate.toFixed(1)}%</div>
                        <div class="result-label">Force Deployment Ratio</div>
                    </div>
                    
                    <div class="result-card">
                        <div class="result-title">üéØ Max Sustainable</div>
                        <div class="result-value">${data.maxSustainable}</div>
                        <div class="result-label">Soldiers per Deployment</div>
                    </div>
                    
                    <div class="result-card">
                        <div class="result-title">‚è±Ô∏è Dwell Time</div>
                        <div class="result-value">${data.dwellTime}</div>
                        <div class="result-label">Months (2:1 Ratio)</div>
                    </div>
                    
                    <div class="result-card">
                        <div class="result-title">üîÑ Total Cycle</div>
                        <div class="result-value">${data.totalCycle}</div>
                        <div class="result-label">Deploy + Dwell Time</div>
                    </div>
                </div>
            `;
        }
        
        function generateTimeline(data) {
            const container = document.getElementById('timeline-container');
            const totalMonths = 36;
            
            // Calculate actual deployment groups based on available personnel
            const deployablePersonnel = data.deployable;
            const deploymentSize = data.deploymentSize;
            const totalGroups = Math.floor(deployablePersonnel / deploymentSize);
            const surplusPersonnel = deployablePersonnel % deploymentSize;
            
            // Calculate cycle timing
            const deploymentLength = data.deploymentLength;
            const dwellLength = deploymentLength * 2; // 2:1 ratio
            const totalCycle = deploymentLength + dwellLength;
            
            let html = `
                <div class="timeline-section">
                    <div class="timeline-title">üìÖ Deployment Gantt Chart - 36 Month Analysis</div>
                    <div class="timeline-subtitle">
                        ${deployablePersonnel} deployable soldiers ‚Üí ${totalGroups} groups of ${deploymentSize} 
                        ${surplusPersonnel > 0 ? `+ ${surplusPersonnel} surplus` : ''}
                        | Groups start every ${deploymentLength - overlap} months
                    </div>
                    <div class="gantt-container">
                        <div class="gantt-header">
                            <div class="gantt-label">Rotation Groups</div>
                            <div class="gantt-months-container">
                                <div class="gantt-months-row gantt-months-tens">
            `;
            
            // Create tens row (10, 20, 30)
            for (let decade = 0; decade < Math.ceil(totalMonths / 10); decade++) {
                const startMonth = decade * 10 + 1;
                const endMonth = Math.min((decade + 1) * 10, totalMonths);
                const span = endMonth - startMonth + 1;
                
                if (decade === 0) {
                    // First decade shows 1-10
                    html += `<div class="month-header-tens" style="grid-column: span ${span};">Months 1-${endMonth}</div>`;
                } else {
                    html += `<div class="month-header-tens" style="grid-column: span ${span};">${startMonth}-${endMonth}</div>`;
                }
            }
            
            html += `
                                </div>
                                <div class="gantt-months-row gantt-months-ones">
            `;
            
            // Create individual month numbers
            for (let month = 1; month <= totalMonths; month++) {
                html += `<div class="month-header">${month}</div>`;
            }
            
            html += `
                                </div>
                            </div>
                        </div>
                        <div class="gantt-body">
            `;
            
            // Generate gantt rows for each actual rotation group
            for (let group = 1; group <= Math.max(totalGroups, 1); group++) {
                const isActiveGroup = group <= totalGroups;
                const groupSize = isActiveGroup ? deploymentSize : 0;
                
                html += `<div class="gantt-row ${group === 1 ? 'primary-group' : ''}">`;
                html += `<div class="gantt-row-label ${group === 1 ? 'primary-label' : ''}">
                    Group ${group}${group === 1 ? ' (Primary)' : ''}
                    <span class="group-size">${groupSize} soldiers</span>
                    ${!isActiveGroup ? '<span class="unavailable-text">Insufficient Personnel</span>' : ''}
                </div>`;
                html += `<div class="gantt-timeline">`;
                
                // Calculate when this group starts based on overlap period
                // Group 1 starts at month 1, Group 2 starts at deployment length minus overlap, etc.
                const groupStartMonth = 1 + ((group - 1) * (deploymentLength - overlap));
                
                for (let month = 1; month <= totalMonths; month++) {
                    let barClass = 'gantt-bar';
                    let barText = '';
                    let barColor = '';
                    let barTitle = '';
                    
                    if (isActiveGroup && month >= groupStartMonth) {
                        // Calculate position in the deployment cycle
                        const monthsFromStart = month - groupStartMonth;
                        const cyclePosition = monthsFromStart % totalCycle;
                        
                        if (cyclePosition < deploymentLength) {
                            // Deployment period
                            barClass += ' deployed';
                            barText = 'D';
                            barColor = group === 1 ? '#c0392b' : '#e74c3c'; // Primary group darker
                            barTitle = `Month ${month}: Group ${group} Deployed (${groupSize} soldiers)`;
                        } else {
                            // Dwell period
                            barClass += ' dwell';
                            barText = '';
                            barColor = group === 1 ? '#229954' : '#27ae60'; // Primary group darker
                            barTitle = `Month ${month}: Group ${group} Dwell Time`;
                        }
                        
                        // Highlight if this is the primary group
                        if (group === 1) {
                            barClass += ' primary';
                        }
                    } else if (isActiveGroup && month < groupStartMonth) {
                        // Pre-deployment preparation
                        barClass += ' preparation';
                        barColor = '#95a5a6';
                        barTitle = `Month ${month}: Group ${group} Preparing`;
                    } else {
                        // Unavailable
                        barClass += ' unavailable';
                        barColor = '#ecf0f1';
                        barTitle = `Month ${month}: Insufficient personnel for Group ${group}`;
                    }
                    
                    html += `<div class="${barClass}" style="background-color: ${barColor}" title="${barTitle}">${barText}</div>`;
                }
                
                html += `</div></div>`;
            }
            
            // Add surplus personnel row if applicable
            if (surplusPersonnel > 0) {
                html += `
                    <div class="gantt-row surplus-row">
                        <div class="gantt-row-label surplus-label">
                            Surplus Personnel
                            <span class="group-size">${surplusPersonnel} soldiers</span>
                            <span class="surplus-text">Available for contingency</span>
                        </div>
                        <div class="gantt-timeline">
                `;
                
                for (let month = 1; month <= totalMonths; month++) {
                    html += `<div class="gantt-bar surplus" style="background-color: #f39c12" title="Month ${month}: ${surplusPersonnel} surplus personnel available">S</div>`;
                }
                
                html += `</div></div>`;
            }
            
            // Add total deployed summary row
            html += `
                        <div class="gantt-row summary-row">
                            <div class="gantt-row-label summary-label">
                                Total Deployed
                                <span class="group-size">Per month</span>
                            </div>
                            <div class="gantt-timeline">
            `;
            
            for (let month = 1; month <= totalMonths; month++) {
                let deployedCount = 0;
                
                // Count deployed personnel across all active groups
                for (let group = 1; group <= totalGroups; group++) {
                    const groupStartMonth = 1 + ((group - 1) * (deploymentLength - overlap));
                    
                    if (month >= groupStartMonth) {
                        const monthsFromStart = month - groupStartMonth;
                        const cyclePosition = monthsFromStart % totalCycle;
                        
                        if (cyclePosition < deploymentLength) {
                            deployedCount += deploymentSize;
                        }
                    }
                }
                
                let summaryColor = '#3498db';
                let summaryText = deployedCount > 0 ? deployedCount.toString() : '';
                
                if (deployedCount === 0) {
                    summaryColor = '#95a5a6';
                    summaryText = '0';
                } else if (deployedCount < deploymentSize) {
                    summaryColor = '#f39c12';
                }
                
                html += `<div class="gantt-bar summary" style="background-color: ${summaryColor}" title="Month ${month}: ${deployedCount} total soldiers deployed">${summaryText}</div>`;
            }
            
            html += `
                            </div>
                        </div>
                    </div>
                    
                    <div class="gantt-legend">
                        <div class="legend-item">
                            <div class="legend-color" style="background: #c0392b;"></div>
                            <span>Primary Group Deployed</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #e74c3c;"></div>
                            <span>Other Groups Deployed</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #27ae60;"></div>
                            <span>Dwell Time (${dwellLength} months)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #f39c12;"></div>
                            <span>Surplus Personnel</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #3498db;"></div>
                            <span>Total Deployed</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #95a5a6;"></div>
                            <span>Preparation/Unavailable</span>
                        </div>
                    </div>
                    
                    <div class="gantt-analysis">
                        <div class="analysis-card">
                            <h4>üìä Force Structure Analysis</h4>
                            <div class="analysis-grid">
                                <div class="analysis-item">
                                    <span class="analysis-label">Total Groups:</span>
                                    <span class="analysis-value">${totalGroups} complete groups</span>
                                </div>
                                <div class="analysis-item">
                                    <span class="analysis-label">Group Size:</span>
                                    <span class="analysis-value">${deploymentSize} soldiers each</span>
                                </div>
                                <div class="analysis-item">
                                    <span class="analysis-label">Personnel Used:</span>
                                    <span class="analysis-value">${totalGroups * deploymentSize} of ${deployablePersonnel}</span>
                                </div>
                                <div class="analysis-item">
                                    <span class="analysis-label">Surplus:</span>
                                    <span class="analysis-value">${surplusPersonnel} soldiers</span>
                                </div>
                                <div class="analysis-item">
                                    <span class="analysis-label">Group Interval:</span>
                                    <span class="analysis-value">${deploymentLength - overlap} months</span>
                                </div>
                                <div class="analysis-item">
                                    <span class="analysis-label">Overlap Period:</span>
                                    <span class="analysis-value">${overlap} months</span>
                                </div>
                                <div class="analysis-item">
                                    <span class="analysis-label">Cycle Length:</span>
                                    <span class="analysis-value">${totalCycle} months total</span>
                                </div>
                                <div class="analysis-item">
                                    <span class="analysis-label">Sustainable:</span>
                                    <span class="analysis-value">${data.feasible ? '‚úÖ Yes' : '‚ùå No'}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            container.innerHTML = html;
        }
        
        function generateRecommendations(data) {
            const container = document.getElementById('recommendations-container');
            let recommendations = [];
            
            if (data.feasible && data.utilizationRate < 70) {
                recommendations = [
                    '‚úÖ Deployment plan is sustainable and provides operational flexibility',
                    'üìà Consider this configuration for long-term planning',
                    'üõ°Ô∏è Sufficient buffer for unexpected personnel changes',
                    '‚öñÔ∏è Excellent work-life balance with proper dwell time'
                ];
            } else if (data.feasible && data.utilizationRate >= 70) {
                recommendations = [
                    '‚ö†Ô∏è Plan works but operates at high utilization - monitor closely',
                    `üìâ Consider reducing to ${data.maxSustainable} soldiers for better sustainability`,
                    'üö® Limited buffer for medical holds or personnel losses',
                    'üìã Implement robust backup planning for contingencies'
                ];
            } else {
                recommendations = [
                    '‚ùå Current manning cannot sustain this deployment requirement',
                    `üéØ Reduce deployment size to ${data.maxSustainable} soldiers maximum`,
                    `üë• Request additional ${Math.abs(data.manningGap)} deployable personnel`,
                    'üìû Negotiate mission requirements with higher command',
                    `‚è∞ Consider extending deployment to ${Math.ceil(data.deploymentLength * 1.5)} months`
                ];
            }
            
            let html = `
                <div class="recommendations">
                    <h3>üí° Strategic Recommendations</h3>
                    <ul>
            `;
            
            recommendations.forEach(rec => {
                html += `<li>${rec}</li>`;
            });
            
            html += `
                    </ul>
                </div>
            `;
            
            container.innerHTML = html;
        }
        
        function exportData() {
            if (!currentResults) {
                alert('Please calculate deployment feasibility first.');
                return;
            }
            
            const csvContent = generateCSVExport(currentResults);
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Deployment_Analysis_${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }
        
        function generateCSVExport(data) {
            return `Military Deployment Feasibility Analysis
Generated: ${new Date().toLocaleString()}

INPUT PARAMETERS
Parameter,Value,Description
Authorized Soldiers,${data.authorized},Total authorized manning level
Assigned Soldiers,${data.assigned},Current personnel assigned to unit
Exempt Soldiers,${data.exempt},Non-deployable personnel
Deployment Size,${data.deploymentSize},Soldiers needed per deployment
Deployment Length,${data.deploymentLength},Duration in months
Overlap Period,${data.overlap},Handover time in months
Deployment Type,${data.deploymentType},Strategy used
Cross Training,${data.crossTraining},Additional training time

CALCULATED RESULTS
Metric,Value,Status
Deployable Soldiers,${data.deployable},Available for deployment
Dwell Time Required,${data.dwellTime},Months (2:1 ratio)
Total Cycle Time,${data.totalCycle},Deploy + Dwell time
Required Personnel,${data.requiredPersonnel},For sustainable ops
Manning Gap,${data.manningGap},${data.manningGap > 0 ? 'SHORTAGE' : 'SURPLUS'}
Max Sustainable Size,${data.maxSustainable},Soldiers per deployment
Utilization Rate,${data.utilizationRate.toFixed(1)}%,Force deployment ratio
Mission Status,${data.feasible ? 'VIABLE' : 'NOT FEASIBLE'},Overall assessment

TIMELINE SUMMARY
Month,Rotation,Status,Personnel
${generateTimelineCSV(data)}

RECOMMENDATIONS
${generateRecommendationsText(data)}`;
        }
        
        function generateTimelineCSV(data) {
            let csv = '';
            const rotationLength = data.deploymentLength - data.overlap;
            
            for (let month = 1; month <= 24; month++) {
                const rotationNum = Math.ceil(month / rotationLength);
                const monthInRotation = ((month - 1) % rotationLength) + 1;
                
                let status = '';
                let personnel = 0;
                
                if (monthInRotation <= data.deploymentLength) {
                    if (data.feasible || month <= (data.deployable * data.deploymentLength / data.deploymentSize)) {
                        status = `Rotation ${rotationNum} Deployed`;
                        personnel = data.deploymentSize;
                    } else {
                        status = 'Mission Failure';
                        personnel = 0;
                    }
                } else {
                    status = 'Dwell Period';
                    personnel = 0;
                }
                
                csv += `${month},${rotationNum},${status},${personnel}\n`;
            }
            
            return csv;
        }
        
        function generateRecommendationsText(data) {
            if (data.feasible && data.utilizationRate < 70) {
                return `1. Deployment plan is sustainable with good flexibility
2. Proceed with current configuration
3. Monitor for any personnel changes
4. Excellent dwell time compliance`;
            } else if (data.feasible && data.utilizationRate >= 70) {
                return `1. High utilization - monitor personnel closely
2. Consider reducing to ${data.maxSustainable} soldiers
3. Plan for contingencies
4. Limited flexibility for changes`;
            } else {
                return `1. Reduce deployment to ${data.maxSustainable} soldiers maximum
2. Request ${Math.abs(data.manningGap)} additional personnel
3. Negotiate mission requirements
4. Consider longer deployment cycles`;
            }
        }
        
        function shareResults() {
            if (!currentResults) {
                alert('Please calculate deployment feasibility first.');
                return;
            }
            
            const shareData = {
                ...currentResults,
                timestamp: new Date().toISOString(),
                url: window.location.href
            };
            
            const shareUrl = `${window.location.href}?data=${encodeURIComponent(btoa(JSON.stringify(shareData)))}`;
            
            const container = document.getElementById('share-container');
            container.innerHTML = `
                <div class="share-section">
                    <h3>üîó Share These Results</h3>
                    <p>Copy this URL to share your analysis with colleagues:</p>
                    <div class="url-display" onclick="copyToClipboard(this.textContent)">
                        ${shareUrl}
                        <button class="copy-btn" onclick="event.stopPropagation(); copyToClipboard('${shareUrl}')">Copy</button>
                    </div>
                    <p style="font-size: 0.9rem; margin-top: 10px;">
                        <strong>Note:</strong> Recipients will see your exact analysis with all parameters and results.
                    </p>
                </div>
            `;
        }
        
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('URL copied to clipboard!');
            }).catch(() => {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('URL copied to clipboard!');
            });
        }
        
        function saveAsFile() {
            const htmlContent = document.documentElement.outerHTML;
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Military_Deployment_Calculator.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            alert('Calculator saved! You can now share this HTML file with colleagues or host it on any web server.');
        }
        
        // Load shared data if present in URL
        function loadSharedData() {
            const urlParams = new URLSearchParams(window.location.search);
            const sharedData = urlParams.get('data');
            
            if (sharedData) {
                try {
                    const data = JSON.parse(atob(decodeURIComponent(sharedData)));
                    
                    // Populate form with shared data
                    document.getElementById('authorized').value = data.authorized;
                    document.getElementById('assigned').value = data.assigned;
                    document.getElementById('exempt').value = data.exempt;
                    document.getElementById('deployment-size').value = data.deploymentSize;
                    document.getElementById('deployment-length').value = data.deploymentLength;
                    document.getElementById('overlap').value = data.overlap;
                    document.getElementById('deployment-type').value = data.deploymentType;
                    document.getElementById('cross-training').value = data.crossTraining;
                    
                    // Auto-calculate
                    setTimeout(() => {
                        calculateDeployment();
                        
                        // Show notification
                        const notification = document.createElement('div');
                        notification.innerHTML = `
                            <div style="background: #d4edda; border: 1px solid #c3e6cb; color: #155724; padding: 15px; border-radius: 8px; margin: 20px; text-align: center;">
                                üì• <strong>Shared Analysis Loaded</strong><br>
                                Analysis shared on ${new Date(data.timestamp).toLocaleString()}
                            </div>
                        `;
                        document.querySelector('.content-area').insertBefore(notification, document.querySelector('.content-area').firstChild);
                        
                        setTimeout(() => notification.remove(), 5000);
                    }, 100);
                    
                } catch (error) {
                    console.error('Error loading shared data:', error);
                }
            }
        }
        
        // Initialize the application
        window.onload = function() {
            loadSharedData();
            if (!new URLSearchParams(window.location.search).get('data')) {
                calculateDeployment();
            }
            
            // Add real-time calculation on input change
            const inputs = ['authorized', 'assigned', 'exempt', 'deployment-size', 'deployment-length', 'overlap', 'cross-training'];
            inputs.forEach(id => {
                document.getElementById(id).addEventListener('input', debounce(calculateDeployment, 500));
            });
            
            document.getElementById('deployment-type').addEventListener('change', calculateDeployment);
        };
        
        // Debounce function for real-time updates
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
    </script>
</body>
</html>
